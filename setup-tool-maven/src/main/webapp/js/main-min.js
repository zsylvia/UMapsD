function changeBuildingFloor(){gettingDirections&&(directionsHTML=$("#dialog_modal").html());var o=[];if(o.push("<form id='change_building_floor_form' onchange='changeBuildingFloorChanged()'>"),o.push("<div class='form-group'>"),o.push("<label for='building_selector'>Building</label>"),o.push("<select class='form-control' id='building_selector' name='building' class='form-control'>"),o.push("<option id='"+GlobalStrings.ALL_BUILDINGS+"' "+(currentBuilding==GlobalStrings.ALL_BUILDINGS?"selected='true'":"")+">"+GlobalStrings.ALL_BUILDINGS_DISPLAY+"</option>"),buildingShortToLongNameMap.forEach(function(e,i){o.push("<option id='"+e+"' "+(currentBuilding==e?"selected='true'":"")+">"+i+"</option>")}),o.push("</select></div><div class='form-group'><label for='floor_selector'>Floor</label><select class='form-control' id='floor_selector' class='form-control'>"),currentBuilding==GlobalStrings.ALL_BUILDINGS){var e,i;if(buildingToFloorIdsMap.forEach(function(o,t){t.forEach(function(o){(null==e||e>o)&&(e=o),(null==i||o>i)&&(i=o)})}),null!=e&&null!=i)for(var t=e;i>=t;t++)o.push("<option id='"+t+"' "+(currentFloor==t?"selected='true'":"")+">"+t+"</option>")}else buildingToFloorIdsMap.get(currentBuilding).forEach(function(e){o.push("<option id='"+e+"' "+(currentFloor==e?"selected='true'":"")+">"+e+"</option>")});o.push("</select></div></form>");var n=[];n.push("<button type='button' class='btn btn-default btn-block' onclick='changeBuildingFloorSubmit()'>OK</button>"),n.push("<button type='button' class='btn btn-default btn-block' onclick='hideChangeBuildingFloorModal()'>Cancel</button>"),$("#dialog_modal .modal-header .close").attr("onclick","hideChangeBuildingFloorModal()"),$("#dialog_modal .modal-title").toggleClass("text-danger",!1),$("#dialog_modal .modal-title").text("Change Building/Floor"),$("#dialog_modal .modal-body").html(o.join("")),$("#dialog_modal .modal-footer").html(n.join("")),$("#dialog_modal").modal("toggle"),changeBuildingFloorShowing=!0}function changeBuildingFloorChanged(){var o;$("#building_selector").val()==GlobalStrings.ALL_BUILDINGS_DISPLAY&&(o=GlobalStrings.ALL_BUILDINGS),buildingShortToLongNameMap.forEach(function(e,i){return i==$("#building_selector").val()?(o=e,!1):void 0});var e=$("#floor_selector").val();if(o!=currentBuilding){if(o!=GlobalStrings.ALL_BUILDINGS){var i,t=buildingToFloorIdsMap.get(o);i=t.contains(e)?e:e<t.first()?t.first():e>t.last()?t.last():t.first(),changedFloor=i}changedBuilding=o}else changedFloor=e;setFloorSelectorForBuilding(null==changedBuilding?currentBuilding:changedBuilding,null==changedFloor?currentFloor:changedFloor)}function changeBuildingFloorSubmit(){var o=!1;null!=changedBuilding&&(o=!0,currentBuilding=changedBuilding),null!=changedFloor&&(o=!0,currentFloor=changedFloor),o&&(showLoading(),setTimeout(function(){showShapesForCurrentBuildingAndFloor(),showRaphael()},50)),hideChangeBuildingFloorModal()}function setFloorSelectorForBuilding(o,e){var i="";if(o==GlobalStrings.ALL_BUILDINGS){if(currentBuilding==GlobalStrings.ALL_BUILDINGS){var t,n;if(buildingToFloorIdsMap.forEach(function(o,e){e.forEach(function(o){(null==t||t>o)&&(t=o),(null==n||o>n)&&(n=o)})}),null!=t&&null!=n)for(var l=t;n>=l;l++){var r=l;i+="<option id='"+r+"' "+(e==r?"selected='true'":"")+">"+r+"</option>"}}}else{var a=buildingToFloorIdsMap.get(o);a.forEach(function(o){i+="<option id='"+o+"' "+(e==o?"selected='true'":"")+">"+o+"</option>"})}$("#floor_selector").html(i)}function hideChangeBuildingFloorModal(){changeBuildingFloorShowing&&($("#dialog_modal").modal("toggle"),changeBuildingFloorShowing=!changeBuildingFloorShowing,changedBuilding=null,changedFloor=null)}function getDirections(){if(gettingDirections)null!=directionsHTML&&$("#dialog_modal").html(directionsHTML);else{gettingDirections=!0;var o=[];o.push("<div id='directions_from'>"),o.push("<label for='directions_from_type'>From (<span><a href='#' onclick='selectFromOnMap()'>Select On Map</a></span>)</label>"),o.push("<select class='form-control' id='directions_from_type' name='directions_from_type' onchange='directionsFromTypeChange()'>"),o.push("<option value='select_type'>Select Type</option>"),o.push(defaultDirectionsTypeHTML()),o.push("</select>"),o.push("</div>"),o.push("<div id='directions_to'>"),o.push("<label for='directions_to_type'>To (<span><a href='#' onclick='selectToOnMap()'>Select On Map</a></span>)</label>"),o.push("<select class='form-control' id='directions_to_type' name='directions_to_type' onchange='directionsToTypeChange()'>"),o.push("<option value='select_type'>Select Type</option>"),o.push(defaultDirectionsTypeHTML()),o.push("</select>"),o.push("<div class='form-group'>"),o.push("<label>Handicap Accessible</label>"),o.push("<div class='form-control'>"),o.push("<label class='radio-inline'><input id='handicap_yes' type='radio' name='handicap' value='yes' onclick='handicapYes()'>Yes</label>"),o.push("<label class='radio-inline'><input id='handicap_no' type='radio' name='handicap' value='no' checked='checked' onclick='handicapNo()'>No</label>"),o.push("</div>"),o.push("</div>"),o.push("</div>");var e=[];e.push("<button type='button' class='btn btn-default btn-block' onclick='findPathSelected()'>Get Directions</button>"),e.push("<button type='button' class='btn btn-default btn-block' onclick='cancelPathfind()'>Cancel</button>"),$("#dialog_modal .modal-header .close").attr("onclick","cancelPathfind()"),$("#dialog_modal .modal-title").toggleClass("text-danger",!1),$("#dialog_modal .modal-title").text("Get Directions"),$("#dialog_modal .modal-body").html(o.join("")),$("#dialog_modal .modal-footer").html(e.join(""))}$("#dialog_modal").modal("toggle")}function handicapYes(){$("#handicap_yes").attr("checked",!0),$("#handicap_no").attr("checked",!1)}function handicapNo(){$("#handicap_yes").attr("checked",!1),$("#handicap_no").attr("checked",!0)}function directionsFromTypeChange(){var o=[];if(o.push("<label for='directions_to_type'>From (<span><a href='#' onclick='selectFromOnMap()'>Select On Map</a></span>)</label>"),null!=selectedFromMarkerOnMap)o.push("<div class='text-primary'>Point selected on map (<span><a href='#' onclick='unselectFromOnMap()'>Unselect point</a></span>)</div>");else{o.push("<select class='form-control' id='directions_from_type' name='directions_from_type' onchange='directionsFromTypeChange()'>");var e=$("#directions_from_type option:selected").val();if(e==GlobalStrings.BUILDING){directionsFromType=GlobalStrings.BUILDING;var i=$("#directions_from_building option:selected").val(),t=$("#directions_from_floor option:selected").val(),n=$("#directions_from_room option:selected").val();o.push(defaultDirectionsTypeHTML(GlobalStrings.BUILDING)+"</select>"),o.push("<select class='form-control' id='directions_from_building' name='directions_from_building' onchange='directionsFromTypeChange()'>"),void 0===i?(o.push("<option value='select_building' selected='true'>Select Building</option>"),buildingShortToLongNameMap.forEach(function(e,i){o.push("<option value='"+e+"'>"+i+"</option>")}),o.push("</select>")):(buildingShortToLongNameMap.forEach(function(e,t){o.push("<option value='"+e+"'"+(i==e?" selected='true'":"")+">"+t+"</option>")}),o.push("</select>"),o.push("<select class='form-control' id='directions_from_floor' name='directions_from_floor' onchange='directionsFromTypeChange()'>"),null!=directionsFromBuilding&&i!=directionsFromBuilding?(directionsFromBuilding=i,directionsFromFloor=null,directionsFromRoom=null,o.push("<option value='select_floor' selected='true'>Select Floor</option>"),buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'>"+e+"</option>")})):(directionsFromBuilding=i,void 0===t?(o.push("<option value='select_floor' selected='true'>Select Floor</option>"),buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'>"+e+"</option>")}),o.push("</select>")):(buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'"+(t==e?" selected='true'":"")+">"+e+"</option>")}),o.push("</select>"),o.push("<select class='form-control' id='directions_from_room' name='directions_from_room' onchange='directionsFromTypeChange()'>"),null!=directionsFromFloor&&t!=directionsFromFloor?(directionsFromFloor=t,directionsFromRoom=null,o.push("<option value='select_room' selected='true'>Select Room</option>"),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'>"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>")):(directionsFromFloor=t,void 0===n?(o.push("<option value='select_room' selected='true'>Select Room</option>"),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'>"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>")):(directionsFromRoom=getRoomFromRoomId(n),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'"+(directionsFromRoom==getRoomFromRoomId(e)?" selected='true'":"")+">"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>"))))))}else if(e==GlobalStrings.PARKING_LOT){directionsFromType=GlobalStrings.PARKING_LOT,directionsFromBuilding=null,directionsFromFloor=null,directionsFromRoom=null,directionsFromParkingLot=null,directionsFromDorm=null,directionsFromMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.PARKING_LOT)+"</select>");var l=$("#directions_from_parking_lot option:selected").val();o.push("<select class='form-control' id='directions_from_parking_lot' name='directions_from_parking_lot' onchange='directionsFromTypeChange()'>"),void 0===l?(o.push("<option value='select_parking_lot' selected='true'>Select Parking Lot</option>"),getMarkerMapForType(GlobalStrings.PARKING_LOT).forEach(function(e){o.push("<option value='"+e+"'>"+getParkingLotFromId(e)+"</option>")}),o.push("</select>")):(getMarkerMapForType(GlobalStrings.PARKING_LOT).forEach(function(e){o.push("<option value='"+e+"'"+(l==e?" selected='true'":"")+">"+getParkingLotFromId(e)+"</option>")}),o.push("</select>"))}else e==GlobalStrings.DORM?(directionsFromType=GlobalStrings.DORM,directionsFromBuilding=null,directionsFromFloor=null,directionsFromRoom=null,directionsFromParkingLot=null,directionsFromDorm=null,directionsFromMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.DORM)+"</select>")):e==GlobalStrings.MISC&&(directionsFromType=GlobalStrings.MISC,directionsFromBuilding=null,directionsFromFloor=null,directionsFromRoom=null,directionsFromParkingLot=null,directionsFromDorm=null,directionsFromMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.MISC)+"</select>"))}$("#directions_from").html(o.join(""))}function directionsToTypeChange(){var o=[];if(o.push("<label for='directions_to_type'>To (<span><a href='#' onclick='selectToOnMap()'>Select On Map</a></span>)</label>"),null!=selectedToMarkerOnMap)o.push("<div class='text-primary'>Point selected on map (<span><a href='#' onclick='unselectToOnMap()'>Unselect point</a></span>)</div>");else{o.push("<select class='form-control' id='directions_to_type' name='directions_to_type' onchange='directionsToTypeChange()'>");var e=$("#directions_to_type option:selected").val();if(e==GlobalStrings.BUILDING){directionsToType=GlobalStrings.BUILDING;var i=$("#directions_to_building option:selected").val(),t=$("#directions_to_floor option:selected").val(),n=$("#directions_to_room option:selected").val();o.push(defaultDirectionsTypeHTML(GlobalStrings.BUILDING)+"</select>"),o.push("<select class='form-control' id='directions_to_building' name='directions_to_building' onchange='directionsToTypeChange()'>"),void 0===i?(o.push("<option value='select_building' selected='true'>Select Building</option>"),buildingShortToLongNameMap.forEach(function(e,i){o.push("<option value='"+e+"'>"+i+"</option>")}),o.push("</select>")):(buildingShortToLongNameMap.forEach(function(e,t){o.push("<option value='"+e+"'"+(i==e?" selected='true'":"")+">"+t+"</option>")}),o.push("</select>"),o.push("<select class='form-control' id='directions_to_floor' name='directions_to_floor' onchange='directionsToTypeChange()'>"),null!=directionsToBuilding&&i!=directionsToBuilding?(directionsToBuilding=i,directionsToFloor=null,directionsToRoom=null,o.push("<option value='select_floor' selected='true'>Select Floor (optional)</option>"),buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'>"+e+"</option>")})):(directionsToBuilding=i,void 0===t?(o.push("<option value='select_floor' selected='true'>Select Floor (optional)</option>"),buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'>"+e+"</option>")}),o.push("</select>")):(buildingToFloorIdsMap.get(i).forEach(function(e){o.push("<option id='"+e+"'"+(t==e?" selected='true'":"")+">"+e+"</option>")}),o.push("</select>"),o.push("<select class='form-control' id='directions_to_room' name='directions_to_room' onchange='directionsToTypeChange()'>"),null!=directionsToFloor&&t!=directionsToFloor?(directionsToFloor=t,directionsToRoom=null,o.push("<option value='select_room' selected='true'>Select Room</option>"),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'>"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>")):(directionsToFloor=t,void 0===n?(o.push("<option value='select_room' selected='true'>Select Room</option>"),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'>"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>")):(directionsToRoom=getRoomFromRoomId(n),typeToMarkerMap.get(GlobalStrings.ROOM).forEach(function(e,n){n.data(GlobalStrings.BUILDING)==i&&n.data(GlobalStrings.FLOOR)==t&&o.push("<option value='"+e+"'"+(directionsToRoom==getRoomFromRoomId(e)?" selected='true'":"")+">"+getRoomFromRoomId(e)+"</option>")}),o.push("</select>"))))))}else if(e==GlobalStrings.PARKING_LOT){directionsToType=GlobalStrings.PARKING_LOT,directionsToBuilding=null,directionsToFloor=null,directionsToRoom=null,directionsToParkingLot=null,directionsToDorm=null,directionsToMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.PARKING_LOT)+"</select>");var l=$("#directions_to_parking_lot option:selected").val();o.push("<select class='form-control' id='directions_to_parking_lot' name='directions_to_parking_lot' onchange='directionsToTypeChange()'>"),void 0===l?(o.push("<option value='select_parking_lot' selected='true'>Select Parking Lot</option>"),getMarkerMapForType(GlobalStrings.PARKING_LOT).forEach(function(e){o.push("<option value='"+e+"'>"+getParkingLotFromId(e)+"</option>")}),o.push("</select>")):(getMarkerMapForType(GlobalStrings.PARKING_LOT).forEach(function(e){o.push("<option value='"+e+"'"+(l==e?" selected='true'":"")+">"+getParkingLotFromId(e)+"</option>")}),o.push("</select>"))}else e==GlobalStrings.DORM?(directionsToType=GlobalStrings.DORM,directionsToBuilding=null,directionsToFloor=null,directionsToRoom=null,directionsToParkingLot=null,directionsToDorm=null,directionsToMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.DORM)+"</select>")):e==GlobalStrings.MISC&&(directionsToType=GlobalStrings.MISC,directionsToBuilding=null,directionsToFloor=null,directionsToRoom=null,directionsToParkingLot=null,directionsToDorm=null,directionsToMisc=null,o.push(defaultDirectionsTypeHTML(GlobalStrings.MISC)+"</select>"))}$("#directions_to").html(o.join(""))}function findPathSelected(){if(directionsParamsValid()){var o=$("#handicap_yes").is(":checked");showingPath=!0;var e,i=directionsFromType,t=directionsToType;if(null!=selectedFromMarkerOnMap?e=selectedFromMarkerOnMap:i==GlobalStrings.BUILDING?e=getMarkerFromId(formatRoomId(directionsFromBuilding,directionsFromFloor,directionsFromRoom)):i==GlobalStrings.DORM?e=getMarkerFromId(formatDormId(directionsFromDorm)):i==GlobalStrings.PARKING_LOT?e=getMarkerFromId(formatParkingLotId(directionsFromParkingLot)):i==GlobalStrings.MISC&&(e=getMarkerFromId(formatMiscId(directionsFromMisc))),null!=e)if(null!=selectedToMarkerOnMap)findPath(e.data(GlobalStrings.ID),selectedToMarkerOnMap.data(GlobalStrings.ID),o);else if(t==GlobalStrings.CLOSEST_BATHROOM_MENS||t==GlobalStrings.CLOSEST_BATHROOM_WOMENS){var n;t==GlobalStrings.CLOSEST_BATHROOM_MENS?n=getClosestBathroomMens(e):t==GlobalStrings.CLOSEST_BATHROOM_WOMENS&&(n=getClosestBathroomWomens(e)),null!=n?findPath(e.data(GlobalStrings.ID),n.data(GlobalStrings.ID)):LOG.error("Cannot find closest bathroom. The result was null!")}else if(t==GlobalStrings.BUILDING)if(null==directionsToFloor){var l;l=o?getPathToBuilding(handicapGraph,e.data(GlobalStrings.ID),directionsToBuilding):getPathToBuilding(nonHandicapGraph,e.data(GlobalStrings.ID),directionsToBuilding),findPath(l[0],l[l.length-1],o)}else findPath(e.data(GlobalStrings.ID),formatRoomId(directionsToBuilding,directionsToFloor,directionsToRoom),o);else t==GlobalStrings.DORM?findPath(e.data(GlobalStrings.ID),formatDormId(directionsToDorm),o):t==GlobalStrings.PARKING_LOT?findPath(e.data(GlobalStrings.ID),formatParkingLotId(directionsToParkingLot),o):t==GlobalStrings.MISC?findPath(e.data(GlobalStrings.ID),formatMiscId(directionsToMisc),o):LOG.error("Invalid directionsToType: "+t);else LOG.error("Cannot find directions. The 'from' marker is null!");cancelPathfind()}}function findPath(o,e,i){var t,n=(new Date).getTime();t=null!=i&&i?getShortestPath(handicapGraph,o,e):getShortestPath(nonHandicapGraph,o,e),directionsPathArray=t,directionsPathArrayPosition=-1,$("#directions").css({width:$(window).width(),height:$("#navbar").height(),display:"table-cell"}),$("#directions_text").css({height:$("#navbar").height(),"line-height":$("#navbar").height()+"px"}),$("#directions_left").css({height:$("#navbar").height()}),$("#directions_right").css({height:$("#navbar").height()}),$("#navbar").css("display","none"),pathMap.forEach(function(o,e){e.element.stop(),e.element.attr({fill:"black",stroke:"black"}),e.element.hide()});for(var l=0,r=t.length;r>l;l++)if(l<t.length-1){var a=pathMap.get(t[l]+"<->"+t[l+1]);null==a&&(a=pathMap.get(t[l+1]+"<->"+t[l]));var s=a.element;null!=s&&s.show().toFront()}showNextDirections(),LOG.trace("Took "+((new Date).getTime()-n)+" ms to find and show path from "+o+" to "+e)}function showNextDirections(){var o=directionsPathArray,e=directionsPathArrayPosition;if(e+1<o.length-1){if(e>=0){var i=pathMap.get(o[e]+"<->"+o[e+1]);null==i&&(i=pathMap.get(o[e+1]+"<->"+o[e]));var t=i.element;t.stop(),t.attr({fill:"black",stroke:"black"})}e++;var n=(Raphael.animation({fill:"red",stroke:"red"},1e3,"<>").repeat(1/0),pathMap.get(o[e]+"<->"+o[e+1]));null==n&&(n=pathMap.get(o[e+1]+"<->"+o[e]));var l=n.element;l.attr({fill:"red",stroke:"red"}),directionsPathArrayPosition=e,$("#directions_text").html(o[e]+" -> "+o[e+1])}}function showPreviousDirections(){var o=directionsPathArray,e=directionsPathArrayPosition;if(e>0){var i=pathMap.get(o[e]+"<->"+o[e+1]);null==i&&(i=pathMap.get(o[e+1]+"<->"+o[e]));var t=i.element;t.stop(),t.attr({fill:"black",stroke:"black"}),e--;var n=(Raphael.animation({fill:"red",stroke:"red"},1e3,"<>").repeat(1/0),pathMap.get(o[e]+"<->"+o[e+1]));null==n&&(n=pathMap.get(o[e+1]+"<->"+o[e]));var l=n.element;l.attr({fill:"red",stroke:"red"}),directionsPathArrayPosition=e,$("#directions_text").html(o[e]+" -> "+o[e+1])}}function setMarkerDragEventHandlers(){}function directionsParamsValid(){var o=!1,e=!1;return directionsFromParamsValid()&&(o=!0),directionsToParamsValid()&&(e=!0),o&&e}function directionsFromParamsValid(){$("#directions_from_error").remove();var o;return null==selectedFromMarkerOnMap&&(null==directionsFromType?o="You must select a type":directionsFromType==GlobalStrings.BUILDING?null==directionsFromBuilding?o="You must select a building":null==directionsFromFloor?o="You must select a floor":null==directionsFromRoom&&(o="You must select a room"):directionsFromType==GlobalStrings.PARKING_LOT?null==directionsFromParkingLot&&(o="You must select a parking lot"):LOG.error("Invalid directionsFromType: "+directionsFromType)),null!=o?($("#directions_from").prepend("<div id='directions_from_error' class='text-danger'>"+o+"</div>"),!1):!0}function directionsToParamsValid(){$("#directions_to_error").remove();var o;return null==selectedToMarkerOnMap&&(null==directionsToType?o="You must select a type":directionsToType==GlobalStrings.BUILDING?null==directionsToBuilding?o="You must select a building":null!=directionsToFloor&&null==directionsToRoom&&(o="You must select a room"):directionsToType==GlobalStrings.PARKING_LOT?null==directionsToParkingLot&&(o="You must select a parking lot"):directionsToType==GlobalStrings.CLOSEST_BATHROOM_MENS||directionsToType==GlobalStrings.CLOSEST_BATHROOM_WOMENS||LOG.error("Invalid directionsToType: "+directionsToType)),null!=o?($("#directions_to").prepend("<div id='directions_to_error' class='text-danger'>"+o+"</div>"),!1):!0}function defaultDirectionsTypeHTML(o){var e=[];return e.push("<option value='"+GlobalStrings.BUILDING+"' "+(o==GlobalStrings.BUILDING?"selected='true'":"")+">"+GlobalStrings.BUILDING_DISPLAY+"</option>"),e.push("<option value='"+GlobalStrings.DORM+"' "+(o==GlobalStrings.DORM?"selected='true'":"")+">"+GlobalStrings.DORM_DISPLAY+"</option>"),e.push("<option value='"+GlobalStrings.PARKING_LOT+"' "+(o==GlobalStrings.PARKING_LOT?"selected='true'":"")+">"+GlobalStrings.PARKING_LOT_DISPLAY+"</option>"),e.push("<option value='"+GlobalStrings.MISC+"' "+(o==GlobalStrings.MISC?"selected='true'":"")+">"+GlobalStrings.MISC_DISPLAY+"</option>"),e.join("")}function selectFromOnMap(){$("#dialog_modal").modal("toggle"),selectingFromOnMap=!0}function selectToOnMap(){$("#dialog_modal").modal("toggle"),selectingToOnMap=!0}function cancelPathfind(){selectingFromOnMap=!1,null!=selectedFromMarkerOnMap&&(selectedFromMarkerOnMap.hide(),selectedFromMarkerOnMap=null),selectingToOnMap=!1,null!=selectedToMarkerOnMap&&(selectedToMarkerOnMap.hide(),selectedToMarkerOnMap=null),ignoreClick=!1,gettingDirections=!1,directionsHTML=null,$("#dialog_modal").modal("toggle")}function showLoading(){$("#shield").css({width:$("#view").width(),height:$("#view").height(),display:"block"}),$("#loading").css("display","block")}function showRaphael(){$("#loading").css("display","none"),$("#shield").css("display","none"),$("#raphael").css("display","block")}var changeBuildingFloorShowing=!1,nonHandicapGraph,handicapGraph,directionsFromType,directionsFromBuilding,directionsFromFloor,directionsFromRoom,directionsFromParkingLot,directionsFromDorm,directionsFromMisc,directionsToType,directionsToBuilding,directionsToFloor,directionsToRoom,directionsToParkingLot,directionsToDorm,directionsToMisc,changedBuilding,changedFloor,ignoreClick=!1,selectingFromOnMap=!1,selectedFromMarkerOnMap,selectingToOnMap=!1,selectedToMarkerOnMap,directionsPathArray,directionsPathArrayPosition,gettingDirections=!1,directionsHTML;currentBuilding=GlobalStrings.ALL_BUILDINGS,currentFloor="1";var LOG=new Logger(LoggingLevel.ALL);$(document).ready(function(){showLoading(),setTimeout(function(){setMarkersInvisible(!0);var o=now();nonHandicapGraph=new Graph,handicapGraph=new Graph,nonHandicapGraph.vertices=nonHandicapGraphVertices,handicapGraph.vertices=handicapGraphVertices,showRaphael(),$(".nav a").on("click",function(){$(window).width()<=768&&$(".navbar-collapse").collapse("hide")}),document.getElementById("raphael").addEventListener("touchstart",function(o){var e=o;if(e.preventDefault&&e.preventDefault(),ignoreClick||draggingEverythingIgnoreClick)ignoreClick=!1;else{var i=paperResizeRatio,t=e.touches[0].pageX*i+paperShiftX,n=(e.touches[0].pageY-($(document).height()-$("#raphael").height()))*i+paperShiftY;console.log(e.touches[0]),selectingFromOnMap?(selectedFromMarkerOnMap=getClosestMarkerToPoint(t,n),selectedFromMarkerOnMap.show(),selectingFromOnMap=!1,directionsFromTypeChange(),$("#dialog_modal").modal("toggle")):selectingToOnMap&&(selectedToMarkerOnMap=getClosestMarkerToPoint(t,n),selectedToMarkerOnMap.show(),selectingToOnMap=!1,directionsToTypeChange(),$("#dialog_modal").modal("toggle"))}},!1),$("#raphael").mouseup(function(o){if(draggingEverythingIgnoreClick&&(ignoreClick=!0,draggingEverythingIgnoreClick=!1),ignoreClick)ignoreClick=!1;else{var e,i,t=o,n=paperResizeRatio;"tspan"==t.target.nodeName||void 0===t.offsetX?(e=t.pageX*n,i=(t.pageY-($(document).height()-$("#raphael").height()))*n):(e=t.offsetX*n,i=t.offsetY*n),e+=paperShiftX,i+=paperShiftY,selectingFromOnMap?(selectedFromMarkerOnMap=getClosestMarkerToPoint(e,i),selectedFromMarkerOnMap.show(),selectingFromOnMap=!1,getDirections(),directionsFromTypeChange()):selectingToOnMap&&(selectedToMarkerOnMap=getClosestMarkerToPoint(e,i),selectedToMarkerOnMap.show(),selectingToOnMap=!1,getDirections(),directionsToTypeChange())}}),LOG.trace("Took "+((new Date).getTime()-o)+" ms to setup main")},50)});